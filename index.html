<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAT ARKLOK - JM INFORMATICA</title>
    <style>
        body {
            font-family: Arial;
            margin: 0;
            padding: 20px 5px;
            background-color: #8caad4;
        }

        .minha-div {
            width: 100px;
            height: 100px;
            display: flex;
            justify-content: center;
            /* centraliza horizontalmente */
            align-items: center;
            /* centraliza verticalmente */
            margin: 50px auto;
            /* centraliza a div na página */
        }

        .minha-div img {
            width: 100px;
            height: 100px;
            cursor: pointer;
            /* indica que é clicável */

        }

        h3 {
            text-align: center;
            margin-bottom: 20px;
        }

        h4 {
            text-align: center;
            font-size: 12px;
            margin-top: 60px;
            margin-bottom: 5px;
        }



        form {
            max-width: 500px;
            margin: auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        label {
            display: block;
            margin-top: 15px;
            font-weight: bold;
        }

        input,
        textarea,
        canvas {
            width: 100%;
            padding: 12px;
            margin-top: 5px;
            font-size: 16px;
            border-radius: 5px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .oculto {
            display: none;
        }


        button {
            margin-top: 20px;
            padding: 15px;
            width: 100%;
            font-size: 18px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        #limparAssinatura {
            background-color: #dc3545;
            margin-top: 5px;
        }

        #limparAssinatura:hover {
            background-color: #a71d2a;
        }

        /* Centraliza todo o bloco de equipamento/serviço */
        form div {
            display: flex;
            flex-direction: column;
            /* cada item em linha separada */
            align-items: center;
            /* centraliza horizontalmente */
            margin-top: 10px;
        }

        /* Cada label em linha separada, texto e checkbox próximos */
        form div label {
            display: flex;
            align-items: center;
            /* checkbox alinhado verticalmente ao meio do texto */
            justify-content: center;
            /* centraliza horizontalmente */
            margin-bottom: 2px;
            /* gap mínimo entre linhas */
            font-weight: normal;
            font-size: 18px;
            white-space: nowrap;
            /* evita quebra de linha nos títulos */
        }

        /* Inputs, checkboxes e select com espaço mínimo do texto */
        form div label input[type="checkbox"],
        form div label input[type="text"],
        form div label select {
            margin-left: 4px;
            /* checkbox bem próximo do texto */
            vertical-align: middle;
            font-size: 15px;
            padding: 3px;
        }

        /* Mantém tamanho específico para alguns campos */
        form div label input[type="text"] {
            width: 180px;
            /* campo "OUTROS" */
        }

        form div label select {
            width: 60px;
            /* select "RETIRADO PARA LABORATÓRIO" */
        }

        /* Remove gaps extras entre quebras de linha */
        form div br {
            line-height: 0px;
        }
    </style>
</head>

<body>

    <div class="minha-div">
        <a href="https://www.jminformatica.com/" target="_blank">
            <img src="https://www.jminformatica.com/img/iconbar.png" alt="JM Informática">
        </a>
    </div>

    <h4>ARKLOK</h4>
    <h3>RAT (RELATÓRIO ATENDIMENTO TÉCNICO)</h3>

    <form id="chamadoForm">

        <h4>DADOS DO TÉCNICO</h4>


        <label for="tecnico">NOME DO TÉCNICO:</label>
        <input type="text" id="tecnico" name="tecnico" required>

        <!-- esse campo empresa parceira está oculto no formulário -->
        <label for="empresa" class="oculto">EMPRESA PARCEIRA:</label>
        <input type="text" id="empresa" name="empresa" value="JM INFORMATICA" readonly class="oculto">


        <label for="chamado">CHAMADO:</label>
        <input type="text" id="chamado" name="chamado" required>

        <label for="data">DATA DO ATENDIMENTO:</label>
        <input type="date" id="data" name="data" required>

        <label for="inicio">Horário de Início:</label>
        <input type="time" id="inicio" name="inicio" required>

        <label for="termino">Horário de Término:</label>
        <input type="time" id="termino" name="termino" required>

        <label for="assinatura">ASSINATURA DO TÉCNICO / RESPONSÁVEL:</label>
        <div style="position: relative;">
            <canvas id="assinatura" width="500" height="150" style="border:1px solid #ccc;"></canvas>
            <div
                style="position: absolute; bottom: 10px; width: 100%; text-align: center; color: #999; font-size: 16px; pointer-events: none;">
                ______ASSINE AQUI______
            </div>
        </div>
        <button type="button" id="limparAssinatura">Limpar Assinatura</button>


        <!-- parte 2 dados do cliente -->

        <h4>DADOS DO CLIENTE</h4>

        <input type="text" id="dados_cliente" name="dados_cliente" readonly class="oculto">

        <label for="razao_social">RAZÃO SOCIAL / NOME FANTASIA:</label>
        <input type="text" id="razao_social" name="razao_social" required>

        <label for="nome_responsavel">NOME DO RESPONSÁVEL:</label>
        <input type="text" id="nome_responsavel" name="nome_responsavel" required>

        <label for="telefone_cliente">TELEFONE:</label>
        <input type="text" id="telefone_cliente" name="telefone_cliente" required>

        <label for="email_cliente">E-MAIL:</label>
        <input type="text" id="email_cliente" name="email_cliente" required>

        <label for="cargo_cliente">CARGO:</label>
        <input type="text" id="cargo_cliente" name="cargo_cliente" required>

        <label for="depto_cliente">DEPARTAMENTO:</label>
        <input type="text" id="depto_cliente" name="depto_cliente" required>


        <!-- BLOCO DE EQUIPAMENTO / SERVIÇO -->
        <div style="margin-top: 10px;">
            <label>
                RETIRADO PARA LABORATÓRIO S/N:
                <select name="retirado_lab">
                    <option value="">--</option>
                    <option value="S">S</option>
                    <option value="N">N</option>
                </select>
            </label>

            <label style="margin-left: 20px;">
                SUBSTITUIÇÃO OU TROCA:
                <input type="checkbox" name="substituicao_troca">
            </label>

            <label style="margin-left: 20px;">
                UPGRADE (ATUALIZAÇÃO SSD, MEMÓRIA):
                <input type="checkbox" name="upgrade">
            </label>

            <br><br>

            <label>NOTEBOOK: <input type="checkbox" name="notebook"></label>
            <label style="margin-left: 15px;">DESKTOP: <input type="checkbox" name="desktop"></label>
            <label style="margin-left: 15px;">IMPRESSORA: <input type="checkbox" name="impressora"></label>
            <label style="margin-left: 15px;">MOBILE: <input type="checkbox" name="mobile"></label>
            <label style="margin-left: 15px;">
                OUTROS:
                <input type="text" name="outros" style="width: 180px;">
            </label>
        </div>


        <h4>DADOS DO(S) EQUIPAMENTO(S)</h4>
        <input type="text" id="dados_eqpto" name="dados_eqpto" readonly class="oculto">
        <input type="text" id="eqpto_antigo" name="eqpto_antigo" readonly class="oculto">
        <input type="text" id="eqpto_novo" name="eqpto_novo" readonly class="oculto">


        <h4>EQUIPAMENTO ANTIGO</h4>

        <label for="modelo_a">MODELO:</label>
        <input type="text" id="modelo_a" name="modelo_a" required>

        <label for="patrimonio_a">N° PATRIMÔNIO DO EQUIPAMENTO:</label>
        <input type="text" id="patrimonio_a" name="patrimonio_a" required>

        <label for="serie_a">N° SÉRIE:</label>
        <input type="text" id="serie_a" name="serie_a" required>

        <label for="hostname_a">HOSTNAME:</label>
        <input type="text" id="hostname_a" name="hostname_a" required>

        <label for="etiqueta_a">N° ETIQUETA E SÉRIE CLIENTE:</label>
        <input type="text" id="etiqueta_a" name="etiqueta_a" required>

        <label for="imei_a">IMEI:</label>
        <input type="text" id="imei_a" name="imei_a" required>


        <h4>EQUIPAMENTO NOVO</h4>

        <label for="modelo_b">MODELO:</label>
        <input type="text" id="modelo_b" name="modelo_b" required>

        <label for="patrimonio_b">N° PATRIMÔNIO DO EQUIPAMENTO:</label>
        <input type="text" id="patrimonio_b" name="patrimonio_b" required>

        <label for="serie_b">N° SÉRIE:</label>
        <input type="text" id="serie_b" name="serie_b" required>

        <label for="hostname_b">HOSTNAME:</label>
        <input type="text" id="hostname_b" name="hostname_b" required>

        <label for="etiqueta_b">N° ETIQUETA E SÉRIE CLIENTE:</label>
        <input type="text" id="etiqueta_b" name="etiqueta_b" required>

        <label for="imei_b">IMEI:</label>
        <input type="text" id="imei_b" name="imei_b" required>

        <h4>INFORMAÇÕES SOBRE BACKUP</h4>

        <label for="backup_a">BACKUP REALIZADO:</label>
        <input type="text" id="backup_a" name="backup_a" required>

        <label for="patrimonio_b1">DETALHAR / PATRIMÔNIO:</label>
        <input type="text" id="patrimonio_b1" name="patrimonio_b1" required>

        <h4>INFORMAÇÕES SOBRE ACESSÓRIOS OU PERIFÉRICOS</h4>

        <label for="usuario_a">NOME PERFIL USUÁRIO:</label>
        <input type="text" id="usuario_a" name="usuario_a" required>

        <label for="patrimonio_b2">DETALHAR / PATRIMÔNIO:</label>
        <input type="text" id="patrimonio_b2" name="patrimonio_b2" required>



        <!-- botão gerar DPF  -->
        <button type="button" id="btnPDF">Gerar PDF</button>



    </form>


    <!-- INICIO DO JAVASCRIPT  -->

    <!-- API que gera o PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>



    <script>
        const canvas = document.getElementById('assinatura');
        const ctx = canvas.getContext('2d');
        let desenhando = false;
        let lastX = 0, lastY = 0;

        function ajustarCanvas() {
            canvas.width = canvas.offsetWidth;
            canvas.height = 150;
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';
        }

        ajustarCanvas();

        // --- Assinatura ---
        function desenhar(e) {
            if (!desenhando) return;
            const rect = canvas.getBoundingClientRect();
            let x = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
            let y = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;

            const dx = x - lastX, dy = y - lastY;
            if (Math.sqrt(dx * dx + dy * dy) > 2) {
                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
                ctx.lineTo(x, y);
                ctx.stroke();
                ctx.closePath();
                lastX = x; lastY = y;
            }
        }

        canvas.addEventListener('mousedown', e => { desenhando = true; const rect = canvas.getBoundingClientRect(); lastX = e.clientX - rect.left; lastY = e.clientY - rect.top; });
        canvas.addEventListener('mouseup', () => desenhando = false);
        canvas.addEventListener('mouseout', () => desenhando = false);
        canvas.addEventListener('mousemove', desenhar);

        canvas.addEventListener('touchstart', e => { desenhando = true; const rect = canvas.getBoundingClientRect(); lastX = e.touches[0].clientX - rect.left; lastY = e.touches[0].clientY - rect.top; e.preventDefault(); });
        canvas.addEventListener('touchend', () => desenhando = false);
        canvas.addEventListener('touchmove', desenhar);

        // Limpar assinatura
        document.getElementById('limparAssinatura').addEventListener('click', () => ctx.clearRect(0, 0, canvas.width, canvas.height));





        // --- Gerar PDF ---


        const { jsPDF } = window.jspdf;

        document.getElementById('btnPDF').addEventListener('click', () => {
            const form = document.getElementById('chamadoForm');
            const doc = new jsPDF({ format: 'a4', unit: 'mm' });

            let xInicio = 10;
            let y = 20;
            const larguraTotal = 190;

            // --- Título principal ---
            doc.setFontSize(14);
            doc.setFont(undefined, 'normal');
            doc.setTextColor(200, 0, 0);
            doc.text("RAT (RELATÓRIO ATENDIMENTO TÉCNICO)", 105, y, { align: "center" });
            y += 10;

            // --- BLOCO DADOS DO CHAMADO ---
            function addCampo(x, y, largura, titulo, valor, padding = 2) {
                const altura = 5; // mesma altura visual do bloco DADOS DO CLIENTE
                const larguraTitulo = largura * 0.4;
                valor = (valor || "").toString().toUpperCase();

                doc.setDrawColor(0);
                doc.setLineWidth(0.3);
                doc.setLineDashPattern([0.3, 0.3], 0);
                doc.rect(x, y, largura, altura, 'S');
                doc.setLineDashPattern([], 0);

                // fundo vermelho do título
                doc.setFillColor(200, 0, 0);
                doc.rect(x, y, larguraTitulo, altura, 'F');

                // centralização vertical (ajustada)
                const yTexto = y + altura / 2 + 2.2;

                // título
                doc.setFont("helvetica", "bold");
                doc.setFontSize(9);
                doc.setTextColor(255, 255, 255);
                doc.text(titulo, x + padding, yTexto);

                // valor
                doc.setFont("helvetica", "normal");
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(9);
                doc.text(valor, x + larguraTitulo + padding, yTexto);
            }

            // --- LINHA 1 ---
            const larguraNome = larguraTotal * 0.50;
            const larguraEmpresa = larguraTotal * 0.50;
            const alturaCampos = 5; // mesma altura padronizada

            addCampo(xInicio, y, larguraNome, "NOME DO TÉCNICO:", form.tecnico.value);
            addCampo(xInicio + larguraNome, y, larguraEmpresa, "EMPRESA PARCEIRA:", form.empresa.value);

            // --- Espaçamento entre linhas ---
            y += alturaCampos + 2;

            // --- LINHA 2 (CHAMADO / DATA / HORÁRIO) ---
            const larguraChamado = larguraTotal * 0.27;
            const larguraData = larguraTotal * 0.38;
            const larguraHorario = larguraTotal - larguraChamado - larguraData;

            // --- CHAMADO ---
            addCampo(xInicio, y, larguraChamado, "CHAMADO:", form.chamado.value, 1);

            // --- DATA DO ATENDIMENTO ---
            const dataInput = form.elements['data'].value;
            const partesData = dataInput.split('-');
            const dataFormatada = partesData.length === 3 ? `${partesData[2]}/${partesData[1]}/${partesData[0]}` : dataInput;

            (function addCampoData(x, y, largura, titulo, valor) {
                const altura = 5; // altura igual ao DADOS DO CLIENTE
                const larguraTitulo = largura * 0.6;
                const padding = 2;

                doc.setDrawColor(0);
                doc.setLineWidth(0.3);
                doc.setLineDashPattern([0.3, 0.3], 0);
                doc.rect(x, y, largura, altura, 'S');
                doc.setLineDashPattern([], 0);

                // fundo vermelho
                doc.setFillColor(200, 0, 0);
                doc.rect(x, y, larguraTitulo, altura, 'F');

                const yTexto = y + altura / 2 + 2.2; // centralização vertical

                // título
                doc.setFont("helvetica", "bold");
                doc.setFontSize(9);
                doc.setTextColor(255, 255, 255);
                doc.text(titulo, x + padding, yTexto);

                // valor
                const xValor = x + larguraTitulo + padding;
                const maxLarguraValor = largura - larguraTitulo - padding * 2 - 9;
                doc.setFont("helvetica", "normal");
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(9);
                doc.text(valor, xValor, yTexto, { maxWidth: maxLarguraValor });
            })(xInicio + larguraChamado, y, larguraData, "DATA DO ATENDIMENTO:", dataFormatada);

            // --- HORÁRIO ---
            const xHorario = xInicio + larguraChamado + larguraData;
            const altura = 5;
            const larguraTituloHorario = 20;

            doc.setDrawColor(0);
            doc.setLineWidth(0.3);
            doc.setLineDashPattern([0.3, 0.3], 0);
            doc.rect(xHorario, y, larguraHorario, altura, 'S');
            doc.setLineDashPattern([], 0);

            // fundo vermelho
            doc.setFillColor(200, 0, 0);
            doc.rect(xHorario, y, larguraTituloHorario, altura, 'F');

            const yTextoHorario = y + altura / 2 + 2.2;

            // título HORÁRIO
            doc.setFont("helvetica", "bold");
            doc.setFontSize(9);
            doc.setTextColor(255, 255, 255);
            doc.text("HORÁRIO:", xHorario + 2, yTextoHorario);

            // conteúdo interno
            doc.setFont("helvetica", "normal");
            doc.setFontSize(9);
            doc.setTextColor(0, 0, 0);

            const inicioVal = form.inicio.value;
            const terminoVal = form.termino.value;

            const larguraConteudo = larguraHorario - larguraTituloHorario;
            const larguraBloco = (larguraConteudo - 1) / 2;

            const yTextoInterno = yTextoHorario;

            // bloco INÍCIO
            const xInicioBloco = xHorario + larguraTituloHorario;
            doc.text("INÍCIO :", xInicioBloco + 1, yTextoInterno);
            doc.text(inicioVal, xInicioBloco + 14, yTextoInterno);

            // bloco FIM
            const xFimBloco = xInicioBloco + larguraBloco + 1.3;
            doc.text("FIM :", xFimBloco + 1, yTextoInterno);
            doc.text(terminoVal, xFimBloco + 11, yTextoInterno);

            y += altura + 3;


            //  BLOCO DADOS DO CLIENTE
            function addBlocoDadosCliente(doc, x, y, larguraTotal, form) {
                const alturaTitulo = 5;
                const alturaBloco = 35;
                const padding = 3;

                // Borda pontilhada (pontos pequenos e próximos)
                doc.setLineWidth(0.3);
                doc.setDrawColor(0);
                doc.setLineDashPattern([0.3, 0.3], 0); // pontinhos menores e mais próximos
                doc.rect(x, y, larguraTotal, alturaBloco, 'S');
                doc.setLineDashPattern([], 0);

                // cabeçalho vermellho
                doc.setFillColor(200, 0, 0);
                doc.rect(x, y, larguraTotal, alturaTitulo, 'F');


                //titulo linha unica
                doc.setFont(undefined, 'bold');
                doc.setFontSize(9);
                doc.setTextColor(255, 255, 255);
                const yTexto = y + (alturaTitulo / 2) + 2; // centraliza verticalmente com leve ajuste
                doc.text("DADOS DO CLIENTE", x + larguraTotal / 2, yTexto, { align: "center" });



                //conteudo interno
                doc.setFont(undefined, 'normal');
                doc.setFontSize(9);
                doc.setTextColor(0, 0, 0);


                let linhaY = y + alturaTitulo + 7;
                doc.text(`RAZÃO SOCIAL / NOME FANTASIA: ${form.razao_social.value || ""}`, x + padding, linhaY);
                linhaY += 7;
                doc.text(`NOME DO RESPONSÁVEL: ${form.nome_responsavel.value || ""}`, x + padding, linhaY);
                linhaY += 7;
                doc.text(`TELEFONE: ${form.telefone_cliente.value || ""}     E-MAIL: ${form.email_cliente.value || ""}`, x + padding, linhaY);
                linhaY += 7;
                doc.text(`CARGO: ${form.cargo_cliente.value || ""}     DEPARTAMENTO: ${form.depto_cliente.value || ""}`, x + padding, linhaY);

                return y + alturaBloco + 5;
            }


            // --- BLOCO DE SERVIÇOS / EQUIPAMENTO CHECKBOX ---
            function addBlocoEquipamento(doc, x, y, larguraTotal, form) {
                const padding = 6;
                const alturaLinha1 = 7;
                const alturaLinha2 = 7;
                const alturaTotal = alturaLinha1 + alturaLinha2; // altura combinada do bloco
                const checkboxSize = 3; // tamanho do quadradinho
                const spacing = 0.5;   // gap mínimo entre colunas

                doc.setFontSize(9);
                doc.setTextColor(0, 0, 0);
                doc.setFont("helvetica", "normal");

                // --- Função para desenhar checkbox ---
                function drawCheckbox(cx, cy, checked) {
                    doc.rect(cx, cy - checkboxSize / 2, checkboxSize, checkboxSize);
                    if (checked) {
                        doc.line(cx, cy - checkboxSize / 2, cx + checkboxSize, cy + checkboxSize / 2);
                        doc.line(cx, cy + checkboxSize / 2, cx + checkboxSize, cy - checkboxSize / 2);
                    }
                }

                // --- Linha 1 ---
                const linha1Y = y + 3.5; // alinhamento vertical
                const itensLinha1 = [
                    { label: `RETIRADO PARA LABORATÓRIO S/N: ${form.retirado_lab.value || ""}`, checked: null },
                    { label: "SUBSTITUIÇÃO OU TROCA:", checked: form.substituicao_troca.checked },
                    { label: "UPGRADE (ATUALIZAÇÃO SSD, MEMÓRIA):", checked: form.upgrade.checked }
                ];

                let cX1 = x + padding;
                itensLinha1.forEach(item => {
                    doc.text(item.label, cX1, linha1Y);
                    if (typeof item.checked === "boolean") {
                        drawCheckbox(cX1 + doc.getTextWidth(item.label) + 2, linha1Y, item.checked);
                    }
                    cX1 += doc.getTextWidth(item.label) + checkboxSize + 3;
                });

                // --- Linha 2 ---
                const linha2Y = y + alturaLinha1 + 3.5;
                const colWidthsLinha2 = [30, 30, 30, 30, 70];
                const itensLinha2 = [
                    { label: "NOTEBOOK:", checked: form.notebook.checked },
                    { label: "DESKTOP:", checked: form.desktop.checked },
                    { label: "IMPRESSORA:", checked: form.impressora.checked },
                    { label: "MOBILE:", checked: form.mobile.checked },
                    { label: `OUTROS: ${form.outros.value || ""}`, checked: null }
                ];

                let cX2 = x + padding;
                itensLinha2.forEach((item, index) => {
                    const lines = doc.splitTextToSize(item.label, colWidthsLinha2[index]);
                    doc.text(lines, cX2, linha2Y);
                    if (typeof item.checked === "boolean") {
                        drawCheckbox(cX2 + colWidthsLinha2[index] - 6, linha2Y, item.checked);
                    }
                    cX2 += colWidthsLinha2[index] + spacing;
                });

                // Retorna Y ajustado com espaçamento mínimo
                return y + alturaTotal + 1; // apenas 1mm de espaço extra
            }

            // BLOCO DADOS DOS EQUIPAMENTOS - LINHA UNICA 
            function addBlocoEquipamentoCorreto(doc, x, y, larguraTotal, form) {
                const alturaTitulo = 5;
                const alturaBloco = 5;
                const padding = 4;

                // Borda pontilhada (pontos pequenos e próximos)
                doc.setLineWidth(0.3);
                doc.setDrawColor(0);
                doc.setLineDashPattern([0.3, 0.3], 0); // pontinhos menores e mais próximos
                doc.rect(x, y, larguraTotal, alturaBloco, 'S');
                doc.setLineDashPattern([], 0);

                // Cabeçalho vermelho
                doc.setFillColor(200, 0, 0);
                doc.rect(x, y, larguraTotal, alturaTitulo, 'F');

                // --- TÍTULO ---
                doc.setFont(undefined, 'bold');
                doc.setFontSize(9);
                doc.setTextColor(255, 255, 255);
                // Centralização vertical dentro do retângulo vermelho
                const yTexto = y + (alturaTitulo / 2) + 2; // ajuste fino (+2 para compensar a altura da fonte)
                doc.text("DADOS DO (S) EQUIPAMENTO (S)", x + larguraTotal / 2, yTexto, { align: "center" });


                // Retorna nova posição y para o próximo bloco
                return y + alturaBloco + 0.4;
            }



            // BLOCO DADOS DOS EQUIPAMENTOS DIVIDIDO EM DUAS PARTES 50% 50%
            function addBlocoEquipamentoDivido(doc, x, y, larguraTotal, form) {
                const alturaTitulo = 5;
                const alturaBloco = 5;

                // Borda pontilhada (pontos pequenos e próximos)
                doc.setLineWidth(0.3);
                doc.setDrawColor(0);
                doc.setLineDashPattern([0.3, 0.3], 0);
                doc.rect(x, y, larguraTotal, alturaBloco, 'S');
                doc.setLineDashPattern([], 0);

                // Metade esquerda e direita (vermelhas)
                const larguraColuna = larguraTotal / 2;
                doc.setFillColor(200, 0, 0);
                doc.rect(x, y, larguraColuna, alturaTitulo, 'F');
                doc.rect(x + larguraColuna, y, larguraColuna, alturaTitulo, 'F');

                // Linha divisória central (pontilhada branca)
                doc.setLineWidth(0.2);
                doc.setDrawColor(255);
                doc.setLineDashPattern([0.3, 0.3], 0);
                doc.line(x + larguraColuna, y, x + larguraColuna, y + alturaTitulo);
                doc.setLineDashPattern([], 0);

                // Texto centralizado em cada metade
                doc.setFont(undefined, 'bold');
                doc.setFontSize(9);
                doc.setTextColor(255, 255, 255);

                // Texto centralizado verticalmente nas duas metades
                const yTexto = y + (alturaTitulo / 2) + 2; // ajuste fino (+2 para compensar a base da fonte)
                doc.text("EQUIPAMENTO ANTIGO", x + larguraColuna / 2, yTexto, { align: "center" });
                doc.text("EQUIPAMENTO NOVO", x + larguraColuna + larguraColuna / 2, yTexto, { align: "center" });


                // Retorna nova posição Y para o próximo bloco
                return y + alturaBloco + 0.5;
            }


            // --- BLOCO MODELO DIVIDIDO EM DUAS PARTES (LADO A / LADO B) ---
            function addBlocoModelo(doc, x, y, larguraTotal, form) {
                const alturaBloco = 35;
                const padding = 4;

                // Borda pontilhada (preta, pequenos pontos)
                doc.setLineWidth(0.3);
                doc.setDrawColor(0);
                doc.setLineDashPattern([0.3, 0.3], 0);
                doc.rect(x, y, larguraTotal, alturaBloco, 'S');
                doc.setLineDashPattern([], 0);

                // Conteúdo interno (fundo branco, texto preto)
                doc.setFont(undefined, 'normal');
                doc.setFontSize(9);
                doc.setTextColor(0, 0, 0);

                // Divide área em duas metades (LADO A e LADO B)
                const larguraColuna = larguraTotal / 2;

                // Linha divisória central (pontilhada)
                doc.setLineWidth(0.2);
                doc.setLineDashPattern([0.3, 0.3], 0);
                doc.line(x + larguraColuna, y, x + larguraColuna, y + alturaBloco);
                doc.setLineDashPattern([], 0);

                // --- LADO A ---
                let linhaYA = y + padding; // posição inicial colada ao topo
                doc.text(`MODELO: ${form.modelo_a?.value || ""}`, x + padding, linhaYA);
                linhaYA += 6;
                doc.text(`N° PATRIMÔNIO DO EQUIPAMENTO: ${form.patrimonio_a?.value || ""}`, x + padding, linhaYA);
                linhaYA += 6;
                doc.text(`N° SÉRIE: ${form.serie_a?.value || ""}`, x + padding, linhaYA);
                linhaYA += 6;
                doc.text(`HOSTNAME: ${form.hostname_a?.value || ""}`, x + padding, linhaYA);
                linhaYA += 6;
                doc.text(`N° ETIQUETA E SÉRIE CLIENTE: ${form.etiqueta_a?.value || ""}`, x + padding, linhaYA);
                linhaYA += 6;
                doc.text(`IMEI: ${form.imei_a?.value || ""}`, x + padding, linhaYA);

                // --- LADO B ---
                let linhaYB = y + padding; // posição inicial colada ao topo
                const xB = x + larguraColuna + padding;
                doc.text(`MODELO: ${form.modelo_b?.value || ""}`, xB, linhaYB);
                linhaYB += 6;
                doc.text(`N° PATRIMÔNIO DO EQUIPAMENTO: ${form.patrimonio_b?.value || ""}`, xB, linhaYB);
                linhaYB += 6;
                doc.text(`N° SÉRIE: ${form.serie_b?.value || ""}`, xB, linhaYB);
                linhaYB += 6;
                doc.text(`HOSTNAME: ${form.hostname_b?.value || ""}`, xB, linhaYB);
                linhaYB += 6;
                doc.text(`N° ETIQUETA E SÉRIE CLIENTE: ${form.etiqueta_b?.value || ""}`, xB, linhaYB);
                linhaYB += 6;
                doc.text(`IMEI: ${form.imei_b?.value || ""}`, xB, linhaYB);

                // Retorna nova posição Y para o próximo bloco
                return y + alturaBloco + 1;
            }


            // BLOCO BACKUP DIVIDIDO EM DUAS PARTES 50% 50%
            function addBlocoBackup(doc, x, y, larguraTotal, form) {
                const alturaTitulo = 5;
                const alturaBloco = 5;

                // Borda pontilhada (pontos pequenos e próximos)
                doc.setLineWidth(0.3);
                doc.setDrawColor(0);
                doc.setLineDashPattern([0.3, 0.3], 0);
                doc.rect(x, y, larguraTotal, alturaBloco, 'S');
                doc.setLineDashPattern([], 0);

                // Metade esquerda e direita (vermelhas)
                const larguraColuna = larguraTotal / 2;
                doc.setFillColor(200, 0, 0);
                doc.rect(x, y, larguraColuna, alturaTitulo, 'F');
                doc.rect(x + larguraColuna, y, larguraColuna, alturaTitulo, 'F');

                // Linha divisória central (pontilhada branca)
                doc.setLineWidth(0.2);
                doc.setDrawColor(255);
                doc.setLineDashPattern([0.3, 0.3], 0);
                doc.line(x + larguraColuna, y, x + larguraColuna, y + alturaTitulo);
                doc.setLineDashPattern([], 0);

                // Texto centralizado em cada metade
                doc.setFont(undefined, 'bold');
                doc.setFontSize(9);
                doc.setTextColor(255, 255, 255);

                // Texto centralizado verticalmente nas duas metades
                const yTexto = y + (alturaTitulo / 2) + 2; // ajuste fino (+2 para compensar a base da fonte)
                doc.text("BACKUP", x + larguraColuna / 2, yTexto, { align: "center" });
                doc.text("ACESSÓRIOS OU PERIFÉRICOS", x + larguraColuna + larguraColuna / 2, yTexto, { align: "center" });


                // Retorna nova posição Y para o próximo bloco
                return y + alturaBloco + 0.5;
            }

            // --- BLOCO BACKUP REALIZADO (LADO A / LADO B) ---
            function addBlocoBackupRealizado(doc, x, y, larguraTotal, form) {
                const alturaTitulo = 5;
                const alturaBloco = 30; // altura do bloco de conteúdo
                const padding = 4;

                // Borda pontilhada (preta, pontos pequenos)
                doc.setLineWidth(0.3);
                doc.setDrawColor(0);
                doc.setLineDashPattern([0.3, 0.3], 0);
                doc.rect(x, y, larguraTotal, alturaBloco + alturaTitulo, 'S');
                doc.setLineDashPattern([], 0);

                // Cabeçalho vermelho com título centralizado
                doc.setFillColor(200, 0, 0);
                doc.rect(x, y, larguraTotal, alturaTitulo, 'F');
                doc.setFont(undefined, 'bold');
                doc.setFontSize(9);
                doc.setTextColor(255, 255, 255);
                const yTexto = y + (alturaTitulo / 2) + 2;
                doc.text("BACKUP REALIZADO", x + larguraTotal / 2, yTexto, { align: "center" });

                // Conteúdo interno (fundo branco, letra preta)
                doc.setFont(undefined, 'normal');
                doc.setFontSize(9);
                doc.setTextColor(0, 0, 0);

                const larguraColuna = larguraTotal / 2;

                // Captura segura dos valores do formulário
                const backup_a = form.backup_a ? form.backup_a.value : "";
                const usuario_a = form.usuario_a ? form.usuario_a.value : "";
                const patrimonio_b1 = form.patrimonio_b1 ? form.patrimonio_b1.value : "";
                const patrimonio_b2 = form.patrimonio_b2 ? form.patrimonio_b2.value : "";

                // --- LADO A ---
                let linhaYA = y + alturaTitulo + padding;
                doc.text(`BACKUP REALIZADO: ${backup_a.toUpperCase()}`, x + padding, linhaYA);
                linhaYA += 6;
                doc.text(`NOME PERFIL USUÁRIO: ${usuario_a.toUpperCase()}`, x + padding, linhaYA);

                // --- LADO B ---
                let linhaYB = y + alturaTitulo + padding;
                const xB = x + larguraColuna + padding;
                doc.text(`DETALHAR / PATRIMÔNIO: ${patrimonio_b1.toUpperCase()}`, xB, linhaYB);
                linhaYB += 6;
                doc.text(`DETALHAR / PATRIMÔNIO: ${patrimonio_b2.toUpperCase()}`, xB, linhaYB);

                // Linha divisória central (pontilhada)
                doc.setLineWidth(0.2);
                doc.setDrawColor(0);
                doc.setLineDashPattern([0.3, 0.3], 0);
                doc.line(x + larguraColuna, y + alturaTitulo, x + larguraColuna, y + alturaTitulo + alturaBloco);
                doc.setLineDashPattern([], 0);

                // Retorna nova posição Y para o próximo bloco
                return y + alturaTitulo + alturaBloco + 5;
            }



            // 1 --- função chamar o bloco dados do cliente
            y = addBlocoDadosCliente(doc, xInicio, y, larguraTotal, form);

            // 2 --- função chamar o bloco serviços checkbox
            y = addBlocoEquipamento(doc, xInicio, y, larguraTotal, form);

            // 3 --- função chamar o bloco DADOS DO (S) EQUIPAMENTO (S)
            y = addBlocoEquipamentoCorreto(doc, xInicio, y, larguraTotal, form);

            // 4 --- função chamar o bloco EQUIPAMENTO ANTIGO e EQUIPAMENTO NOVO  50% cada 
            y = addBlocoEquipamentoDivido(doc, xInicio, y, larguraTotal, form);

            y = addBlocoModelo(doc, xInicio, y, larguraTotal, form);

            y = addBlocoBackup(doc, xInicio, y, larguraTotal, form);

            y = addBlocoBackupRealizado(doc, xInicio, y, larguraTotal, form);




            // salvar pdf -- isso fica no fim do codigo
            const chamadoNum = form.chamado.value || 'sem_numero';
            doc.save(`Chamado_${chamadoNum}.pdf`);
        });
    </script>
</body>

</html>
